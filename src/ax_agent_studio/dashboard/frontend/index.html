<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Factory | aX Monitor Studio</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè≠</text></svg>">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üè≠ Agent Factory</h1>
            <div class="header-actions">
                <div id="kill-switch-status" style="display: none; margin-right: 1rem; padding: 0.5rem 1rem; background: #fef3c7; color: #92400e; border-radius: 4px; font-weight: 600;">
                    üõë Kill Switch Active
                </div>
                <button id="pause-all-btn" class="btn btn-danger" title="Pause all running agents">üõë Pause All</button>
                <button id="reset-all-btn" class="btn btn-warning" title="Reset backlog for all agents in this environment">üîÑ Reset</button>
                <button id="kill-btn" class="btn btn-danger" title="Nuclear option: Force kill ALL monitor processes (kills money burning!)">‚ò†Ô∏è Kill</button>
            </div>
        </header>

        <div class="main-content">
            <!-- Left Panel: Monitor Control -->
            <div class="left-panel">
                <section class="card">
                    <h2 style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="toggleRunningAgents()">
                        <span>ü§ñ Running Agents</span>
                        <span id="agents-toggle" style="font-size: 1.2rem;">‚ñº</span>
                    </h2>
                    <div id="monitors-list" class="monitors-list">
                        <p class="empty-state">No agents running</p>
                    </div>
                </section>

                <section class="card">
                    <h2 style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="toggleDeployForm()">
                        <span>‚ö° Deploy New Agent</span>
                        <span id="deploy-toggle" style="font-size: 1.2rem;">‚ñº</span>
                    </h2>
                    <form id="start-monitor-form">
                        <div class="form-group">
                            <label for="environment-select">Environment:</label>
                            <select id="environment-select" required>
                                <option value="">Loading...</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="agent-select">Agent:</label>
                            <select id="agent-select" required>
                                <option value="">Select environment first...</option>
                            </select>
                            <small class="form-help" id="agent-help"></small>
                        </div>

                        <div class="form-group">
                            <label for="monitor-type-select">Agent Type:</label>
                            <select id="monitor-type-select" required>
                                <option value="echo">üîä Echo (Simple)</option>
                                <option value="ollama">ü§ñ Ollama (AI)</option>
                                <option value="langgraph" selected>üß† LangGraph (Tools)</option>
                                <option value="frameworks">üß© Frameworks (Docs)</option>
                            </select>
                        </div>

                        <div class="form-group" id="provider-group" style="display: none;">
                            <label for="provider-select">Provider:</label>
                            <select id="provider-select" required>
                                <option value="">Loading...</option>
                            </select>
                            <small class="form-help" id="provider-help"></small>
                        </div>

                        <div class="form-group" id="model-group" style="display: none;">
                            <label for="model-select">Model:</label>
                            <select id="model-select">
                                <option value="">Loading...</option>
                            </select>
                        </div>

                        <div class="form-group" id="system-prompt-group" style="display: none;">
                            <label for="system-prompt-select">System Prompt (optional):</label>
                            <select id="system-prompt-select">
                                <option value="">None (use model defaults)</option>
                            </select>
                            <small class="form-help" id="prompt-help">Choose a personality template</small>
                        </div>

                        <div class="form-group" id="frameworks-info" style="display: none;">
                            <div class="frameworks-info-card">
                                <h3>üß© Framework Spotlight: OpenAI Agents SDK</h3>
                                <p>
                                    Combine <strong>openai-agents</strong> with the <strong>openai-agents-mcp</strong> extension to register
                                    remote MCP tools alongside local utilities.
                                </p>

                                <div class="frameworks-section">
                                    <h4>Installation</h4>
                                    <pre><code>pip install openai-agents
pip install openai-agents-mcp</code></pre>
                                </div>

                                <div class="frameworks-section">
                                    <h4>Architecture Pattern</h4>
                                    <p>Composable agents wire tasks, tools, and message routing together. The MCP registry discovers remote tool schemas and exposes them as native agent actions.</p>
                                </div>

                                <div class="frameworks-section">
                                    <h4>Key Components</h4>
                                    <ul>
                                        <li><strong>Agent</strong> ‚Äì Orchestrates task flow and tool execution.</li>
                                        <li><strong>Tool</strong> ‚Äì Sync or async tool contracts.</li>
                                        <li><strong>McpToolRegistry</strong> ‚Äì Discovers MCP servers and registers their tools.</li>
                                        <li><code>.add_tool()</code> ‚Äì Attach MCP or local tools to the active agent.</li>
                                    </ul>
                                </div>

                                <div class="frameworks-section">
                                    <h4>MCP Integration</h4>
                                    <pre><code>from openai_agents import Agent
from openai_agents_mcp import McpToolRegistry

mcp_registry = McpToolRegistry(
    mcp_server_urls=[
        "http://localhost:8000",
        "http://mcp-prod.company.com",
    ]
)

agent = Agent(name="data-analyst", tools=[])
agent.add_tool(mcp_registry.get_tool("run_sql"))
agent.add_tool(mcp_registry.get_tool("summarize"))

response = agent.run(
    input="Summarize Q3 revenue and run a SQL report."
)
print(response)</code></pre>
                                </div>

                                <div class="frameworks-section">
                                    <h4>Custom Local Tool</h4>
                                    <pre><code>from openai_agents import Tool

class AddTool(Tool):
    def call(self, x, y):
        return x + y

agent.add_tool(AddTool("add"))</code></pre>
                                </div>

                                <div class="frameworks-section">
                                    <h4>MCP Patterns</h4>
                                    <ul>
                                        <li>Register MCP servers via HTTP or stdio endpoints.</li>
                                        <li>Auto-discover OpenAPI or JSON schemas for validation.</li>
                                        <li>Blend MCP tools with local utilities seamlessly.</li>
                                        <li>Supports streaming, function-call, and synchronous workflows.</li>
                                    </ul>
                                </div>

                                <div class="frameworks-section">
                                    <h4>Design Highlights</h4>
                                    <ul>
                                        <li><strong>Composable</strong> ‚Äì Mix MCP and non-MCP tools per workflow.</li>
                                        <li><strong>Schema-driven</strong> ‚Äì Enforces JSON schema types from MCP definitions.</li>
                                        <li><strong>Flexible transport</strong> ‚Äì HTTP or stdio transport options.</li>
                                        <li><strong>Type-safe outputs</strong> ‚Äì Structured responses aligned with tool schemas.</li>
                                    </ul>
                                </div>

                                <div class="frameworks-section">
                                    <h4>Best For</h4>
                                    <p>Rapidly prototyping agent workflows that blend remote MCP services with OpenAI-style function calling.</p>
                                </div>

                                <div class="frameworks-section sources">
                                    <h4>Sources</h4>
                                    <ul>
                                        <li><a href="https://github.com/lastmile-ai/openai-agents-mcp" target="_blank" rel="noopener noreferrer">OpenAI Agents MCP Extension</a></li>
                                        <li><a href="https://composio.dev/blog/building-mcp-agents-with-openai-agents-sdk" target="_blank" rel="noopener noreferrer">Building MCP agents with OpenAI Agents SDK</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">‚ñ∂Ô∏è Deploy Agent</button>
                    </form>
                </section>

                <section class="card">
                    <h2>üì¶ Deployment Groups</h2>
                    <div id="deployment-groups-list" class="deployment-groups-list">
                        <p class="empty-state">Loading deployment groups...</p>
                    </div>
                </section>
            </div>

            <!-- Right Panel: Logs -->
            <div class="right-panel">
                <section class="card logs-card">
                    <h2 style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="toggleLiveLogs()">
                        <span>üìú Live Logs</span>
                        <span id="logs-toggle" style="font-size: 1.2rem;">‚ñº</span>
                    </h2>
                    <div id="logs-section">
                    <div class="logs-controls">
                        <select id="log-filter">
                            <option value="all">All Agents</option>
                        </select>
                        <button id="refresh-logs-btn" class="btn btn-secondary btn-sm">üîÑ Refresh</button>
                        <button id="copy-logs-btn" class="btn btn-secondary btn-sm">üìã Copy</button>
                        <button id="clear-logs-btn" class="btn btn-secondary btn-sm">üóëÔ∏è Clear</button>
                        <div class="checkbox-stack">
                            <label class="checkbox-label">
                                <input type="checkbox" id="auto-scroll" checked>
                                Auto-scroll
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="verbose-mode" checked>
                                Verbose
                            </label>
                        </div>
                    </div>
                    <div id="logs-container" class="logs-container">
                        <p class="empty-state">Waiting for logs...</p>
                    </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
